Experimental code needed for THRII footswitch POC.

### Setup (Ubuntu)

Requires `libportmidi-dev`

```
sudo apt-get install libportmidi-dev
```

If when you try and build you get errors like `undefined reference to symbol 'Pt_Start'`

Just get a package from somewhere else. It seems the package is broken in some versions of Ubuntu.

e.g. https://debian.pkgs.org/9/debian-main-amd64/libportmidi-dev_217-6_amd64.deb.html

### THRII Sysex Format

Messages are in the following format (as far as I've been able to decode their meaning):

|                 | Num. Bytes | Example    | Description  
|-----------------|------------|------------|-------------------------------------
| Start           | 1          | `f0`       | standard sysex start byte.
| Manufacturer ID | 3          | `00 01 0x` | Yamaha (line6) extended manufacturer code
| Preamble        | 3          | `24 02 4d` | Some kind of device ID I guess. This never changes on my device.
| ?               | 1          | `00`       | Seems to be some kind of command grouping. Usually 00 or 01.
| Sequence Num.   | 1          | `01`       | This gets incremented for each command sent. But seems to be independent between "groups" (previous byte).
| ?               | 2          | `00 00`    | This always seems to be zeros for commands being sent to the amp. But for events generated by the amp it is usually `00 01`
| Payload Size?   | 1          | `03`       | I think this describes the content of the payload somehow, e.g. it's type. If it's `03` the payload will be 8 bytes. If it's `07` or `0b` the payload will be 32 bytes.
| Payload         | ?          | `...`      | The payload size seems to depend on the previous byte and contains mysterious data in an unknown format.
| End             | 1          | `f7`       | Standard sysex end byte.


### Notes on reverse engineering the THR II

The device uses standard MIDI over USB for the desktop app. This traffic can be recorded on windows
using [usbpcap](https://desowin.org/usbpcap/) and then viewed in Wireshark.

You can interact with the amp using raw sysex messages using Bome SendSX.

Pressing buttons on the amp will emit events (e.g. that you can view on sendsx) HOWEVER
this is only true if you first of all tell the amp to do so, either by opening and closing the app first,
or by sending the command see (pkg/amp/requests).
 